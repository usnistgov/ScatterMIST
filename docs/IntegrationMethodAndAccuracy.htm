<html><head>
<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
<script src="https://pages.nist.gov/nist-header-footer/js/jquery-1.9.0.min.js" type="text/javascript" defer="defer"></script>
<script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>
   <link rel="STYLESHEET" href="style.css" type="text/css">
   <title>Modeled Integrated Scatter Tool (MIST)</title>
   <meta name="keywords" content="scattering, optics, light, brdf, 
				bidirectional, mueller matrix, stokes matrix,
				polarimetry, polarization, ellipsometry, reflectance">
   <meta name="description" content="Modeled Integrated Scatter Tool (MIST)">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}});
</script>
<script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

</head>
<body>

<a name="top"><!-- --></a>

<br clear=all>

<center><h1>Modeled Integrated Scatter Tool (MIST)</h1></center>

<hr>

<h2>Begin: <a href="./index.htm">Table of Contents</a><br>
  Previous: <a href="./Expressions.htm">Expressions</a><br>
  Next: <a href="./ExamplesAndOtherNotes.htm">Examples and Other Notes</a></h2>

<h2>11. Integration Method and Accuracy</h2>

<p>While most of the BRDF models contained in the <a href=
"https://pages.nist.gov/SCATMECH/docs">SCATMECH</a> library are
based upon physical principles, many are approximations that have a
limited range of accuracy. It is up to the user to assess the accuracy
of each model to determine if the results are of quantitative value or
are just qualitative guides to data trends.

<p>In order to facilitate the integration of Eq. (2), it helps to make
a change of variables, so that the coverage of sampled points is more
uniform over the scattering hemisphere. There are a number of options
  for such a change of variables. If we let $\xi_1=\theta_{\rm s}\cos\phi_{\rm s}$ and
  $\eta_1=\theta_{\rm s}\sin\phi_{\rm s}$,
  then Eq. (2) becomes
  \begin{equation}\rho(\Omega) = \int_\Omega f_{\rm r}(\theta_{\rm i},\theta_{\rm s},\phi_{\rm s}) \cos\theta_{\rm s}\; {\rm sinc}\;\theta_{\rm s}\;{\rm d}\xi_1\;{\rm d}\eta_1.
  \end{equation}
  
<p>Versions of MIST before 4.00 used Eq. (3) for the
  integration. However, the change of variables $\xi_2=\sqrt{1-\cos\theta_{\rm s}}\cos\phi_{\rm s}$
  and $\xi_2=\sqrt{1-\cos\theta_{\rm s}}\sin\phi_{\rm s}$
allows for a uniform coverage of sampled points in
  solid angle. In that case, Eq. (2) becomes
  \begin{equation}\rho(\Omega) = 2\int_\Omega f_{\rm r}(\theta_{\rm i},\theta_{\rm s},\phi_{\rm s}) \cos\theta_{\rm s}\;{\rm d}\xi_2\;{\rm d}\eta_2.
\end{equation}
  
<p>The change of variables $\xi_3=\sin\theta_{\rm s}\cos\phi_{\rm s}$
  $\eta_3=\sin\theta_{\rm s}\cos\phi_{\rm s}$
  3sssincosξθφ = and 3sssinsinηθφ = allows
for uniform coverage of sampled points in <i>projected</i> solid angle,
$\cos\theta_{\rm s}\;{\rm d}\Omega$; in this case, Eq. (2) becomes 
  \begin{equation}\rho(\Omega) = \int_\Omega f_{\rm r}(\theta_{\rm i},\theta_{\rm s},\phi_{\rm s})\;{\rm d}\xi_3\;{\rm d}\eta_3.
\end{equation}
  
<p>MIST Version 4.00 now uses Eq. (6) by default, but allows the user
to use any of Eqs. (5) – (7), with a uniformly sampled grid or with
Monte Carlo sampling.
  
<p>Any numerical integration introduces errors from the finite
sampling of the integrand. For two-dimensional integration with a
fixed sampling grid and a complex boundary, these errors are
compounded by the sampling at the edges. For this reason, integration
is performed twice, once with the desired model, yielding $\rho(\Omega)$, and
once with a perfectly reflecting diffuser (PRD), yielding $\rho_{\rm PRD}(\Omega)$.
The projected solid angle $\Omega_{\rm proj}$ is also calculated from the nominal
boundary. Since $\rho_{\rm PRD}(\Omega)=\Omega_{\rm proj}/\pi$, the results of $\rho(\Omega)$ are adjusted by
the factor $\Omega_{\rm proj}/[\pi\rho_{\rm PRD}(\Omega)]$, where $\rho_{\rm PRD}(\Omega)$ determined numerically
using the same sampled points and $\Omega_{\rm proj}$ is determined from a line
integral around irregular boundaries,
  \begin{equation}
  \Omega_{\rm proj}=\int_\Omega {\rm d}\xi_3\;{\rm d}\eta_3 = \oint_{\partial\Omega}(\eta_3\;{\rm d}\xi_3-\xi_3\;{\rm d}\eta_3),
  \end{equation}
<p>or, using an exact expression for circular boundaries.
  
<p>Aside from the intrinsic accuracy of the particular model, the
accuracy of the integration depends upon the values of the variables
<b>SOLIDANGLE</b> and <b>MINSAMPLES</b>, any structure in the scattering within the
integration solid angle, and the shape of the integration solid
angle. The program chooses the number of sampled points by dividing
the solid angle of a right circular cone that circumscribes the
integration solid angle by the variable <b>SOLIDANGLE</b>, assuring that this
value is above <b>MINSAMPLES</b>. It then samples directions on a square grid
within this right circular cone. If the point is outside of the
integration solid angle, it returns zero intensity for that
direction. The results are adjusted by the ratio of the calculated
projected solid angle (as determined by the sampled points) and the
actual projected solid angle of the desired shape, as determined by a
path integral around the perimeter.
  
<p>If the user creates a variable <b>integrationmode</b>, the integration
method can be set. The following table gives the permitted values and
their meaning:<p>

    <table border="1" cellpadding="5">
      <tr>
	<th>integrationmode</th>
	<th>Interpretation</th>
	<th>Normalization</th>
      </tr>
      <tr>
	<td>1</td>
	<td>Use Eq. (5), sampling $\xi_1$ and $\eta_1$ on a uniform grid</td>
	<td>Normalize to PRD</td>
      <tr>
      <tr>
	<td>2 (default)</td>
	<td>Use Eq. (6), sampling $\xi_2$ and $\eta_2$ on a uniform grid</td>
	<td>Normalize to PRD</td>
      </tr>
      <tr>
	<td>3</td>
	<td>Use Eq. (7), sampling $\xi_3$ and $\eta_3$ on a uniform grid</td>
	<td>Normalize to PRD</td>
      </tr>
      <tr>
	<td>4</td>
	<td>Use Eq. (5), sampling $\xi_1$ and $\eta_1$ with uniform Monte Carlo sampling</td>
	<td>Normalize to PRD</td>
      </tr>
      <tr>
	<td>5</td>
	<td>Use Eq. (6), sampling $\xi_2$ and $\eta_2$ with uniform Monte Carlo sampling</td>
	<td>Normalize to PRD</td>
      </tr>
      <tr>
	<td>6</td>
	<td>Use Eq. (7), sampling $\xi_3$ and $\eta_3$ with uniform Monte Carlo sampling</td>
	<td>Normalize to PRD</td>
      </tr>
      <tr>
	<td>11</td>
	<td>Use Eq. (5), sampling $\xi_1$ and $\eta_1$ on a uniform grid</td>
	<td>Not normalized</td>
      </tr>
      <tr>
	<td>12</td>
	<td>Use Eq. (6), sampling $\xi_2$ and $\eta_2$ on a uniform grid</td>
	<td>Not normalized</td>
      </tr>
      <tr>
	<td>13</td>
	<td>Use Eq. (7), sampling $\xi_3$ and $\eta_3$ on a uniform grid</td>
	<td>Not normalized</td>
      </tr>
      <tr>
	<td>14</td>
	<td>Use Eq. (5), sampling $\xi_1$ and $\eta_1$ with uniform Monte Carlo sampling</td>
	<td>Not normalized</td>
      </tr>
      <tr>
	<td>15</td>
	<td>Use Eq. (6), sampling $\xi_2$ and $\eta_2$ with uniform Monte Carlo sampling</td>
	<td>Not normalized</td>
      </tr>
      <tr>
	<td>16</td>
	<td>Use Eq. (7), sampling $\xi_3$ and $\eta_3$ with uniform Monte Carlo sampling</td>
	<td>      Not normalized</td>
      </tr>
    </table>


<hr>
<p>
<a href="http://www.nist.gov/pml/div685/grp06/germer.cfm">SCATMECH Technical Information and Questions</a><br>
<a href="http://www.nist.gov/pml/div685/index.cfm" target="_top">Sensor Science Division Home Page</a><br>
<a href="mailto:fraser@nist.gov">Sensor Science Division Inquiries</a><br>
<a href="mailto:thomas.germer@nist.gov">Website Comments</a>
<p>Latest MIST Version: 4.10 (October 2017)</p>

<!-- END FOOTER -->

</td>
</tr>
</table>

</body>
</html>
